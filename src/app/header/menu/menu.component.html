<ul class="menu">
  <li class="menu-item" *ngFor="let item of menu">
    <ng-container *ngIf="item.__typename === 'Menu'; else normalMenu">
      <a [href]="getUrl(item.page)" (click)="onNavigation(item.page, $event)">
        {{item.label}}
      </a>
      <ul class="menu-dropdown" [class.sectioned]="isMenuSectioned(item)">
        <li *ngFor="let subitem of item.items; trackBy: trackMenuItemsFn" [class.sectioned]="subitem.__typename === 'Menu'">
          <ng-container *ngIf="subitem.__typename === 'Menu'; else normalSubMenu">
            <div class="title">
              <ng-container *ngIf="subitem.page; else noLink">
                <a [href]="getUrl(subitem.page)" (click)="onNavigation(subitem.page, $event)">
                  {{subitem.label}}
                </a>
              </ng-container>
              <ng-template #noLink>
                <span>
                  {{subitem.label}}
                </span>
              </ng-template>
              <button (click)="toggleSection(subitem)">
                <span *ngIf="openedSection !== subitem.label" class="fa fa-fw fa-plus" aria-label="expand section"></span>
                <span *ngIf="openedSection === subitem.label" class="fa fa-fw fa-minus" aria-label="collapse section"></span>
              </button>
            </div>
            <ul class="submenu-section" [class.open]="isOpen(subitem)" [class.wrapped]="subitem.items.length > 6">
              <li *ngFor="let sectionitem of subitem.items; trackBy: trackMenuItemsFn">
                <a [href]="getUrl(sectionitem)" (click)="onNavigation(sectionitem, $event)">
                  {{sectionitem.title}}
                </a>
              </li>
            </ul>
          </ng-container>
          <ng-template #normalSubMenu>
            <a [href]="getUrl(subitem)" (click)="onNavigation(subitem, $event)">
              {{subitem.title}}
            </a>
          </ng-template>
        </li>
      </ul>
    </ng-container>
    <ng-template #normalMenu>
      <a [href]="getUrl(item)" (click)="onNavigation(item, $event)">
        {{item.title}}
      </a>
    </ng-template>
  </li>
</ul>
